<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PocketHelp - Teacher Support Platform</title>
    <style>
        /* ============================================
           POCKETHELP STYLES
           ============================================
           SECTION 8: Mobile-friendly layout (max-width: 480px)
           Main color: #89cff0 (Sky Blue)
           ============================================ */

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: #f5f5f5;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        /* SECTION 8: Mobile-first phone-style layout */
        #app {
            width: 100%;
            max-width: 480px;  /* Mobile-friendly max width */
            background: white;
            border-radius: 20px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
            overflow: hidden;
            min-height: 600px;
        }

        /* Header - Main color #89cff0 (Sky Blue) */
        .header {
            background: #89cff0;  /* Main platform color */
            color: white;
            padding: 20px;
            text-align: center;
            position: relative;
        }

        .header h1 {
            font-size: 24px;
            font-weight: 600;
        }

        .back-btn {
            position: absolute;
            left: 20px;
            top: 50%;
            transform: translateY(-50%);
            background: rgba(255, 255, 255, 0.2);
            border: none;
            color: white;
            padding: 8px 15px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
        }

        .back-btn:hover {
            background: rgba(255, 255, 255, 0.3);
        }

        /* Content */
        .content {
            padding: 30px 20px;
        }

        /* Buttons */
        .btn {
            width: 100%;
            padding: 15px;
            background: #89cff0;
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            margin-bottom: 15px;
            transition: background 0.3s;
        }

        .btn:hover {
            background: #6fb8db;
        }

        .btn-secondary {
            background: #e0e0e0;
            color: #333;
        }

        .btn-secondary:hover {
            background: #d0d0d0;
        }

        .btn-danger {
            background: #ff6b6b;
        }

        .btn-danger:hover {
            background: #ff5252;
        }

        .btn-large {
            padding: 40px;
            font-size: 20px;
            margin-bottom: 20px;
        }

        /* Forms */
        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            color: #333;
            font-weight: 500;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 14px;
            font-family: inherit;
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #89cff0;
        }

        .form-group textarea {
            resize: vertical;
            min-height: 100px;
        }

        /* Profile Picture Upload */
        .profile-pic-upload {
            text-align: center;
            margin-bottom: 20px;
        }

        .profile-pic-preview {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            background: #e0e0e0;
            margin: 0 auto 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
        }

        .profile-pic-preview img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .profile-pic-preview .placeholder {
            font-size: 48px;
            color: #999;
        }

        /* Assessment */
        .assessment-question {
            margin-bottom: 30px;
        }

        .assessment-question h3 {
            margin-bottom: 15px;
            color: #333;
            font-size: 16px;
        }

        .slider-container {
            margin-bottom: 10px;
        }

        input[type="range"] {
            width: 100%;
            margin: 10px 0;
        }

        .slider-labels {
            display: flex;
            justify-content: space-between;
            font-size: 12px;
            color: #666;
        }

        .radio-group {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .radio-option {
            display: flex;
            align-items: center;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            cursor: pointer;
            transition: border-color 0.3s;
        }

        .radio-option:hover {
            border-color: #89cff0;
        }

        .radio-option input[type="radio"] {
            margin-right: 10px;
        }

        /* Results */
        .result-card {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 20px;
        }

        .result-card h3 {
            color: #89cff0;
            margin-bottom: 15px;
        }

        .result-card p {
            color: #666;
            line-height: 1.6;
            margin-bottom: 10px;
        }

        .result-card ul {
            margin-left: 20px;
            color: #666;
        }

        /* Community Hub */
        .category-selector {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 20px;
        }

        .category-btn {
            padding: 10px 15px;
            background: #f0f0f0;
            border: 2px solid transparent;
            border-radius: 20px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s;
        }

        .category-btn.active {
            background: #89cff0;
            color: white;
            border-color: #89cff0;
        }

        .post-card {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 12px;
            margin-bottom: 15px;
            cursor: pointer;
            transition: background 0.3s;
        }

        .post-card:hover {
            background: #e9ecef;
        }

        .post-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 10px;
        }

        .post-author {
            font-weight: 600;
            color: #333;
            font-size: 14px;
        }

        .post-category {
            background: #89cff0;
            color: white;
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 12px;
        }

        .post-title {
            font-size: 16px;
            font-weight: 600;
            color: #333;
            margin-bottom: 8px;
        }

        .post-content {
            color: #666;
            font-size: 14px;
            line-height: 1.5;
        }

        .post-meta {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 10px;
            font-size: 12px;
            color: #999;
        }

        .reply-count {
            color: #89cff0;
        }

        /* Post Detail */
        .post-detail {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 20px;
        }

        .reply-card {
            background: white;
            padding: 12px;
            border-radius: 8px;
            margin-bottom: 10px;
            border-left: 3px solid #89cff0;
        }

        .reply-author {
            font-weight: 600;
            color: #333;
            font-size: 13px;
            margin-bottom: 5px;
        }

        .reply-content {
            color: #666;
            font-size: 14px;
            line-height: 1.5;
        }

        /* Personal Account */
        .profile-header {
            text-align: center;
            margin-bottom: 30px;
        }

        .profile-header .profile-pic-preview {
            width: 100px;
            height: 100px;
        }

        .profile-info {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 12px;
            margin-bottom: 15px;
        }

        .profile-info h3 {
            color: #89cff0;
            font-size: 14px;
            margin-bottom: 5px;
        }

        .profile-info p {
            color: #666;
            font-size: 14px;
        }

        /* Link styling */
        .text-link {
            color: #89cff0;
            text-decoration: underline;
            cursor: pointer;
            font-size: 14px;
            display: inline-block;
            margin-top: 10px;
        }

        .text-link:hover {
            color: #6fb8db;
        }

        /* Hidden class */
        .hidden {
            display: none;
        }

        /* Delete button in post */
        .delete-btn-small {
            background: #ff6b6b;
            color: white;
            border: none;
            padding: 5px 12px;
            border-radius: 6px;
            font-size: 12px;
            cursor: pointer;
            margin-left: 10px;
        }

        .delete-btn-small:hover {
            background: #ff5252;
        }

        /* Error message */
        .error-message {
            background: #ffebee;
            color: #c62828;
            padding: 10px;
            border-radius: 8px;
            margin-bottom: 15px;
            font-size: 14px;
        }

        /* Success message */
        .success-message {
            background: #e8f5e9;
            color: #2e7d32;
            padding: 10px;
            border-radius: 8px;
            margin-bottom: 15px;
            font-size: 14px;
        }
    </style>
</head>
<body>
    <div id="app"></div>

    <script>
        // ============================================
        // POCKETHELP - TEACHER SUPPORT PLATFORM
        // ============================================
        //
        // REQUIREMENTS IMPLEMENTATION:
        // ‚úÖ SECTION 3: Main Page with Emotional Assessment & Community Hub
        // ‚úÖ SECTION 4: Emotional Assessment with sliders/multiple choice ‚Üí somatic exercises OR peer support
        // ‚úÖ SECTION 5: Community Hub (Reddit-style) with posts, replies, admin delete, localStorage
        // ‚úÖ SECTION 6: Account System with Admin/Teacher roles, profile setup
        // ‚úÖ SECTION 8: Browser-based, no backend, mobile layout, state management
        // ‚úÖ SECTION 9: Complete runnable mockup with sample data
        //
        // ============================================
        // DATA STORAGE AND INITIALIZATION
        // ============================================

        // Initialize localStorage with mock data if not exists
        // SECTION 9: Sample mock user data and community posts
        function initializeData() {
            if (!localStorage.getItem('pockethelp_users')) {
                const mockUsers = [
                    {
                        id: 1,
                        email: 'admin@pockethelp.com',
                        password: 'admin123',
                        role: 'admin',
                        name: 'Sarah Admin',
                        position: 'Principal',
                        subject: 'Administration',
                        teachingMethod: 'Leadership',
                        whyJoined: 'To support our teaching community',
                        profilePic: null
                    },
                    {
                        id: 2,
                        email: 'teacher@pockethelp.com',
                        password: 'teacher123',
                        role: 'teacher',
                        name: 'John Teacher',
                        position: 'High School Teacher',
                        subject: 'Mathematics',
                        teachingMethod: 'Problem-based learning',
                        whyJoined: 'To connect with other educators',
                        profilePic: null
                    }
                ];
                localStorage.setItem('pockethelp_users', JSON.stringify(mockUsers));
            }

            if (!localStorage.getItem('pockethelp_posts')) {
                const mockPosts = [
                    {
                        id: 1,
                        authorId: 2,
                        authorName: 'John Teacher',
                        category: 'Classroom Management',
                        title: 'Struggling with student engagement',
                        content: 'Has anyone found effective strategies for keeping students engaged during long lessons? I teach high school math and find it challenging to maintain attention.',
                        timestamp: Date.now() - 86400000,
                        replies: [
                            {
                                id: 1,
                                authorName: 'Sarah Admin',
                                content: 'Try breaking lessons into 15-minute segments with quick activities in between. It really helps!',
                                timestamp: Date.now() - 43200000
                            }
                        ]
                    },
                    {
                        id: 2,
                        authorId: 1,
                        authorName: 'Sarah Admin',
                        category: 'Emotional Support',
                        title: 'Self-care reminder',
                        content: 'Remember that taking care of yourself is not selfish. What are your favorite self-care activities?',
                        timestamp: Date.now() - 172800000,
                        replies: []
                    },
                    {
                        id: 3,
                        authorId: 2,
                        authorName: 'John Teacher',
                        category: 'Lesson Ideas',
                        title: 'Interactive math games',
                        content: 'I created a simple card game for practicing algebra. Would anyone be interested in the details?',
                        timestamp: Date.now() - 259200000,
                        replies: [
                            {
                                id: 1,
                                authorName: 'Sarah Admin',
                                content: 'Yes please! Always looking for new ideas.',
                                timestamp: Date.now() - 172800000
                            }
                        ]
                    },
                    {
                        id: 4,
                        authorId: 1,
                        authorName: 'Sarah Admin',
                        category: 'Burnout Prevention',
                        title: 'Setting boundaries',
                        content: 'Learning to say no has been crucial for my wellbeing. How do you all set boundaries between work and personal life?',
                        timestamp: Date.now() - 345600000,
                        replies: []
                    },
                    {
                        id: 5,
                        authorId: 2,
                        authorName: 'John Teacher',
                        category: 'Student Motivation',
                        title: 'Rewarding effort vs. achievement',
                        content: 'I\'ve been experimenting with praising effort rather than just correct answers. Seeing some positive changes!',
                        timestamp: Date.now() - 432000000,
                        replies: []
                    },
                    {
                        id: 6,
                        authorId: 1,
                        authorName: 'Sarah Admin',
                        category: 'Staff Relationships',
                        title: 'Building teacher community',
                        content: 'What are some ways we can better support each other as colleagues?',
                        timestamp: Date.now() - 518400000,
                        replies: []
                    }
                ];
                localStorage.setItem('pockethelp_posts', JSON.stringify(mockPosts));
            }
        }

        // ============================================
        // STATE MANAGEMENT
        // ============================================
        // SECTION 8: Front-end state for login, roles, assessment results, posts, replies
        // SECTION 8: Uses localStorage for persistence between sessions

        const AppState = {
            currentUser: null,
            currentScreen: 'login',
            signupData: {},
            selectedCategory: 'All',
            selectedPostId: null,
            assessmentResults: null,

            setCurrentUser(user) {
                this.currentUser = user;
                if (user) {
                    localStorage.setItem('pockethelp_currentUser', JSON.stringify(user));
                } else {
                    localStorage.removeItem('pockethelp_currentUser');
                }
            },

            loadCurrentUser() {
                const userData = localStorage.getItem('pockethelp_currentUser');
                if (userData) {
                    this.currentUser = JSON.parse(userData);
                    return true;
                }
                return false;
            },

            logout() {
                this.currentUser = null;
                this.currentScreen = 'login';
                localStorage.removeItem('pockethelp_currentUser');
                render();
            }
        };

        // ============================================
        // DATABASE OPERATIONS
        // ============================================
        // SECTION 5 & 8: Data stored in localStorage (temporary/persistent)
        // SECTION 9: Mock database functions for users and posts

        const DB = {
            // SECTION 8: localStorage-based data persistence
            getUsers() {
                return JSON.parse(localStorage.getItem('pockethelp_users') || '[]');
            },

            saveUsers(users) {
                localStorage.setItem('pockethelp_users', JSON.stringify(users));
            },

            getPosts() {
                return JSON.parse(localStorage.getItem('pockethelp_posts') || '[]');
            },

            savePosts(posts) {
                localStorage.setItem('pockethelp_posts', JSON.stringify(posts));
            },

            findUser(email, password) {
                const users = this.getUsers();
                return users.find(u => u.email === email && u.password === password);
            },

            createUser(userData) {
                const users = this.getUsers();
                const newUser = {
                    id: Date.now(),
                    ...userData
                };
                users.push(newUser);
                this.saveUsers(users);
                return newUser;
            },

            // SECTION 5: Create new posts
            createPost(postData) {
                const posts = this.getPosts();
                const newPost = {
                    id: Date.now(),
                    authorId: AppState.currentUser.id,
                    authorName: AppState.currentUser.name,
                    timestamp: Date.now(),
                    replies: [],
                    ...postData
                };
                posts.unshift(newPost);
                this.savePosts(posts);
                return newPost;
            },

            // SECTION 5: Reply to posts
            addReply(postId, content) {
                const posts = this.getPosts();
                const post = posts.find(p => p.id === postId);
                if (post) {
                    post.replies.push({
                        id: Date.now(),
                        authorName: AppState.currentUser.name,
                        content: content,
                        timestamp: Date.now()
                    });
                    this.savePosts(posts);
                }
            },

            // SECTION 5: Admin users can delete posts
            deletePost(postId) {
                let posts = this.getPosts();
                posts = posts.filter(p => p.id !== postId);
                this.savePosts(posts);
            }
        };

        // ============================================
        // SCREEN COMPONENTS
        // ============================================

        // ===== SECTION 6: ACCOUNT SYSTEM =====
        // Login Screen - Matches stored mock user data
        function renderLoginScreen() {
            return `
                <div class="header">
                    <h1>PocketHelp</h1>
                </div>
                <div class="content">
                    <h2 style="margin-bottom: 20px; color: #333;">Welcome Back</h2>
                    <div id="error-container"></div>
                    <form id="login-form">
                        <div class="form-group">
                            <label>Email</label>
                            <input type="email" id="login-email" required>
                        </div>
                        <div class="form-group">
                            <label>Password</label>
                            <input type="password" id="login-password" required>
                        </div>
                        <button type="submit" class="btn">Log In</button>
                    </form>
                    <button class="btn btn-secondary" onclick="navigateTo('signup')">Sign Up</button>
                    <div style="margin-top: 20px; padding: 15px; background: #e3f2fd; border-radius: 8px; font-size: 13px;">
                        <strong>Demo Accounts:</strong><br>
                        Admin: admin@pockethelp.com / admin123<br>
                        Teacher: teacher@pockethelp.com / teacher123
                    </div>
                </div>
            `;
        }

        // ===== SECTION 6: ACCOUNT SYSTEM =====
        // Signup Screen - Role selection (Admin or Teacher)
        function renderSignupScreen() {
            return `
                <div class="header">
                    <button class="back-btn" onclick="navigateTo('login')">‚Üê Back</button>
                    <h1>Sign Up</h1>
                </div>
                <div class="content">
                    <div id="error-container"></div>
                    <form id="signup-form">
                        <div class="form-group">
                            <label>Name</label>
                            <input type="text" id="signup-name" required>
                        </div>
                        <div class="form-group">
                            <label>Email</label>
                            <input type="email" id="signup-email" required>
                        </div>
                        <div class="form-group">
                            <label>Password</label>
                            <input type="password" id="signup-password" required>
                        </div>
                        <div class="form-group">
                            <label>Role</label>
                            <select id="signup-role" required>
                                <option value="">Select Role</option>
                                <option value="teacher">Teacher</option>
                                <option value="admin">Admin</option>
                            </select>
                        </div>
                        <button type="submit" class="btn">Continue to Profile Setup</button>
                    </form>
                </div>
            `;
        }

        // ===== SECTION 6: ACCOUNT SYSTEM =====
        // Account Setup Screen - Profile picture upload + background info
        // Collects: Position, Subject, Teaching Method, Why Joined
        function renderAccountSetupScreen() {
            return `
                <div class="header">
                    <button class="back-btn" onclick="navigateTo('signup')">‚Üê Back</button>
                    <h1>Setting Up Account</h1>
                </div>
                <div class="content">
                    <div class="profile-pic-upload">
                        <div class="profile-pic-preview" id="profile-preview">
                            <span class="placeholder">üë§</span>
                        </div>
                        <input type="file" id="profile-pic-input" accept="image/*" style="display: none;">
                        <button class="btn btn-secondary" onclick="document.getElementById('profile-pic-input').click()">
                            Choose Profile Picture
                        </button>
                    </div>

                    <form id="setup-form">
                        <div class="form-group">
                            <label>Position at School</label>
                            <input type="text" id="setup-position" placeholder="e.g., Elementary Teacher, Principal" required>
                        </div>
                        <div class="form-group">
                            <label>Subject (if relevant)</label>
                            <input type="text" id="setup-subject" placeholder="e.g., Mathematics, English">
                        </div>
                        <div class="form-group">
                            <label>Favorite Teaching Method</label>
                            <input type="text" id="setup-method" placeholder="e.g., Project-based learning">
                        </div>
                        <div class="form-group">
                            <label>Why did you join PocketHelp?</label>
                            <textarea id="setup-why" required placeholder="Share what brought you here..."></textarea>
                        </div>
                        <button type="submit" class="btn">Complete Setup</button>
                    </form>
                </div>
            `;
        }

        // ===== SECTION 3: MAIN PAGE (HOME PAGE) =====
        // After login, displays two main options:
        // 1. Emotional Assessment (Emotional Support)
        // 2. Community Hub (Professional Advice)
        // Plus link to Personal Account
        function renderMainPage() {
            return `
                <div class="header">
                    <h1>PocketHelp</h1>
                </div>
                <div class="content">
                    <h2 style="margin-bottom: 30px; color: #333;">Welcome, ${AppState.currentUser.name}!</h2>

                    <button class="btn btn-large" onclick="navigateTo('assessment')">
                        üßò Emotional Assessment
                    </button>

                    <button class="btn btn-large" onclick="navigateTo('community')">
                        üí¨ Community Hub
                    </button>

                    <div style="text-align: center; margin-top: 20px;">
                        <a class="text-link" onclick="navigateTo('account')">üë§ Personal Account</a>
                    </div>

                    <button class="btn btn-secondary" onclick="AppState.logout()" style="margin-top: 30px;">
                        Log Out
                    </button>
                </div>
            `;
        }

        // ===== SECTION 4: EMOTIONAL ASSESSMENT FLOW =====
        // Short emotional assessment using sliders and multiple choice
        function renderAssessmentScreen() {
            return `
                <div class="header">
                    <button class="back-btn" onclick="navigateTo('main')">‚Üê Back</button>
                    <h1>Emotional Assessment</h1>
                </div>
                <div class="content">
                    <p style="margin-bottom: 30px; color: #666;">
                        Let's check in on how you're feeling today. This quick assessment will help us provide personalized support.
                    </p>

                    <form id="assessment-form">
                        <div class="assessment-question">
                            <h3>How stressed do you feel today?</h3>
                            <div class="slider-container">
                                <input type="range" id="stress-level" min="1" max="10" value="5">
                                <div class="slider-labels">
                                    <span>Relaxed</span>
                                    <span>Very Stressed</span>
                                </div>
                            </div>
                        </div>

                        <div class="assessment-question">
                            <h3>How energized do you feel?</h3>
                            <div class="slider-container">
                                <input type="range" id="energy-level" min="1" max="10" value="5">
                                <div class="slider-labels">
                                    <span>Exhausted</span>
                                    <span>Very Energized</span>
                                </div>
                            </div>
                        </div>

                        <div class="assessment-question">
                            <h3>What best describes your current mood?</h3>
                            <div class="radio-group">
                                <label class="radio-option">
                                    <input type="radio" name="mood" value="positive" required>
                                    <span>Positive and optimistic</span>
                                </label>
                                <label class="radio-option">
                                    <input type="radio" name="mood" value="neutral">
                                    <span>Neutral, just going through the day</span>
                                </label>
                                <label class="radio-option">
                                    <input type="radio" name="mood" value="overwhelmed">
                                    <span>Overwhelmed or anxious</span>
                                </label>
                                <label class="radio-option">
                                    <input type="radio" name="mood" value="down">
                                    <span>Down or discouraged</span>
                                </label>
                            </div>
                        </div>

                        <div class="assessment-question">
                            <h3>Do you feel you need support right now?</h3>
                            <div class="radio-group">
                                <label class="radio-option">
                                    <input type="radio" name="support" value="no" required>
                                    <span>No, I'm doing okay</span>
                                </label>
                                <label class="radio-option">
                                    <input type="radio" name="support" value="maybe">
                                    <span>Maybe, some tips would help</span>
                                </label>
                                <label class="radio-option">
                                    <input type="radio" name="support" value="yes">
                                    <span>Yes, I could use some support</span>
                                </label>
                            </div>
                        </div>

                        <button type="submit" class="btn">Get My Results</button>
                    </form>
                </div>
            `;
        }

        // ===== SECTION 4: EMOTIONAL ASSESSMENT FLOW =====
        // Assessment Results - Shows one of two outputs:
        // 1. Somatic exercise suggestions (for high stress/low energy)
        // 2. Peer support suggestion (link to Community Hub)
        function renderAssessmentResultsScreen() {
            const results = AppState.assessmentResults;
            let recommendation = '';

            // Determine recommendation based on results
            if (results.stressLevel >= 7 || results.energyLevel <= 3 || results.mood === 'overwhelmed' || results.mood === 'down') {
                // OUTPUT 1: Somatic Exercise Suggestions
                recommendation = `
                    <div class="result-card">
                        <h3>üßò Somatic Exercise Suggestions</h3>
                        <p>Based on your responses, we recommend trying some grounding exercises:</p>
                        <ul>
                            <li><strong>Deep Breathing:</strong> Breathe in for 4 counts, hold for 4, exhale for 6. Repeat 5 times.</li>
                            <li><strong>Body Scan:</strong> Close your eyes and mentally scan from head to toe, releasing tension.</li>
                            <li><strong>Progressive Muscle Relaxation:</strong> Tense and release each muscle group.</li>
                            <li><strong>5-4-3-2-1 Grounding:</strong> Name 5 things you see, 4 you can touch, 3 you hear, 2 you smell, 1 you taste.</li>
                        </ul>
                        <p style="margin-top: 15px;">Take a few minutes to try one of these exercises. Your wellbeing matters!</p>
                    </div>
                `;
            } else {
                recommendation = `
                    <div class="result-card">
                        <h3>‚ú® You're Doing Great!</h3>
                        <p>It looks like you're managing well today. Keep up the good work!</p>
                    </div>
                `;
            }

            if (results.support === 'yes' || results.support === 'maybe') {
                // OUTPUT 2: Peer Support Suggestion (link to Community Hub)
                recommendation += `
                    <div class="result-card">
                        <h3>üí¨ Peer Support Available</h3>
                        <p>You don't have to go through this alone. Our community is here for you.</p>
                        <p>Consider visiting the <a class="text-link" onclick="navigateTo('community')">Community Hub</a> to connect with fellow educators who understand what you're going through.</p>
                        <p style="margin-top: 15px;">The Emotional Support category is a great place to share and find encouragement.</p>
                    </div>
                `;
            }

            return `
                <div class="header">
                    <button class="back-btn" onclick="navigateTo('main')">‚Üê Back</button>
                    <h1>Your Results</h1>
                </div>
                <div class="content">
                    ${recommendation}
                    <button class="btn" onclick="navigateTo('assessment')">Take Assessment Again</button>
                    <button class="btn btn-secondary" onclick="navigateTo('main')">Return to Main Page</button>
                </div>
            `;
        }

        // ===== SECTION 5: COMMUNITY HUB (MOCK REDDIT-STYLE) =====
        // Lightweight forum feed with:
        // - Display posts from mock dataset (stored in localStorage)
        // - Filter by category
        // - Create new posts
        // - Reply to posts
        // - Admin users can delete posts
        function renderCommunityHubScreen() {
            const categories = ['All', 'Classroom Management', 'Student Motivation', 'Emotional Support',
                              'Lesson Ideas', 'Staff Relationships', 'Burnout Prevention'];
            const posts = DB.getPosts();
            const filteredPosts = AppState.selectedCategory === 'All'
                ? posts
                : posts.filter(p => p.category === AppState.selectedCategory);

            let categoriesHTML = categories.map(cat => `
                <button class="category-btn ${cat === AppState.selectedCategory ? 'active' : ''}"
                        onclick="selectCategory('${cat}')">
                    ${cat}
                </button>
            `).join('');

            let postsHTML = filteredPosts.map(post => `
                <div class="post-card" onclick="viewPost(${post.id})">
                    <div class="post-header">
                        <span class="post-author">${post.authorName}</span>
                        <span class="post-category">${post.category}</span>
                    </div>
                    <div class="post-title">${post.title}</div>
                    <div class="post-content">${post.content.substring(0, 100)}${post.content.length > 100 ? '...' : ''}</div>
                    <div class="post-meta">
                        <span>${formatTimestamp(post.timestamp)}</span>
                        <span class="reply-count">${post.replies.length} replies</span>
                    </div>
                </div>
            `).join('');

            if (filteredPosts.length === 0) {
                postsHTML = '<p style="text-align: center; color: #999; padding: 40px 0;">No posts in this category yet.</p>';
            }

            return `
                <div class="header">
                    <button class="back-btn" onclick="navigateTo('main')">‚Üê Back</button>
                    <h1>Community Hub</h1>
                </div>
                <div class="content">
                    <div style="margin-bottom: 20px;">
                        <button class="btn" onclick="navigateTo('create-post')">+ Create New Post</button>
                    </div>

                    <div style="margin-bottom: 20px; text-align: center;">
                        <a class="text-link" onclick="navigateTo('assessment')">üßò Mental State Assessment</a>
                        <span style="margin: 0 10px; color: #ccc;">|</span>
                        <a class="text-link" onclick="navigateTo('account')">üë§ Personal Account</a>
                    </div>

                    <h3 style="margin-bottom: 15px; color: #333;">Categories</h3>
                    <div class="category-selector">
                        ${categoriesHTML}
                    </div>

                    <h3 style="margin-bottom: 15px; color: #333;">Posts</h3>
                    ${postsHTML}
                </div>
            `;
        }

        // ===== SECTION 5: COMMUNITY HUB =====
        // Create Post - User can create new posts with category selection
        function renderCreatePostScreen() {
            const categories = ['Classroom Management', 'Student Motivation', 'Emotional Support',
                              'Lesson Ideas', 'Staff Relationships', 'Burnout Prevention'];

            return `
                <div class="header">
                    <button class="back-btn" onclick="navigateTo('community')">‚Üê Back</button>
                    <h1>Create Post</h1>
                </div>
                <div class="content">
                    <form id="create-post-form">
                        <div class="form-group">
                            <label>Category</label>
                            <select id="post-category" required>
                                <option value="">Select Category</option>
                                ${categories.map(cat => `<option value="${cat}">${cat}</option>`).join('')}
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Title</label>
                            <input type="text" id="post-title" required placeholder="What's on your mind?">
                        </div>
                        <div class="form-group">
                            <label>Content</label>
                            <textarea id="post-content" required placeholder="Share your thoughts, questions, or experiences..."></textarea>
                        </div>
                        <button type="submit" class="btn">Post to Community</button>
                    </form>
                </div>
            `;
        }

        // ===== SECTION 5: COMMUNITY HUB =====
        // Post Detail - View post with replies
        // Features: Reply to posts, Admin can delete posts
        function renderPostDetailScreen() {
            const post = DB.getPosts().find(p => p.id === AppState.selectedPostId);
            if (!post) {
                return renderCommunityHubScreen();
            }

            // ADMIN FEATURE: Admin users can delete any post
            const isAdmin = AppState.currentUser.role === 'admin';
            const canDelete = isAdmin || post.authorId === AppState.currentUser.id;

            let repliesHTML = post.replies.map(reply => `
                <div class="reply-card">
                    <div class="reply-author">${reply.authorName}</div>
                    <div class="reply-content">${reply.content}</div>
                    <div style="font-size: 11px; color: #999; margin-top: 5px;">${formatTimestamp(reply.timestamp)}</div>
                </div>
            `).join('');

            if (post.replies.length === 0) {
                repliesHTML = '<p style="text-align: center; color: #999; padding: 20px 0;">No replies yet. Be the first to reply!</p>';
            }

            return `
                <div class="header">
                    <button class="back-btn" onclick="navigateTo('community')">‚Üê Back</button>
                    <h1>Post Detail</h1>
                </div>
                <div class="content">
                    <div class="post-detail">
                        <div class="post-header">
                            <span class="post-author">${post.authorName}</span>
                            <span class="post-category">${post.category}</span>
                        </div>
                        <div class="post-title">${post.title}</div>
                        <div class="post-content" style="margin-top: 10px;">${post.content}</div>
                        <div style="font-size: 12px; color: #999; margin-top: 10px;">
                            ${formatTimestamp(post.timestamp)}
                            ${canDelete ? `<button class="delete-btn-small" onclick="deletePost(${post.id})">Delete Post</button>` : ''}
                        </div>
                    </div>

                    <h3 style="margin-bottom: 15px; color: #333;">Replies (${post.replies.length})</h3>
                    ${repliesHTML}

                    <form id="reply-form" style="margin-top: 20px;">
                        <div class="form-group">
                            <label>Add a Reply</label>
                            <textarea id="reply-content" required placeholder="Share your thoughts..."></textarea>
                        </div>
                        <button type="submit" class="btn">Post Reply</button>
                    </form>
                </div>
            `;
        }

        // ===== SECTION 6: ACCOUNT SYSTEM =====
        // Personal Account - Display user profile information
        // Shows: Profile picture, role, position, subject, teaching method, why joined
        function renderPersonalAccountScreen() {
            const user = AppState.currentUser;

            return `
                <div class="header">
                    <button class="back-btn" onclick="navigateTo('main')">‚Üê Back</button>
                    <h1>Personal Account</h1>
                </div>
                <div class="content">
                    <div class="profile-header">
                        <div class="profile-pic-preview">
                            ${user.profilePic ? `<img src="${user.profilePic}" alt="Profile">` : '<span class="placeholder">üë§</span>'}
                        </div>
                        <h2 style="color: #333; margin-bottom: 5px;">${user.name}</h2>
                        <p style="color: #89cff0; font-weight: 600;">${user.role.charAt(0).toUpperCase() + user.role.slice(1)}</p>
                    </div>

                    <div class="profile-info">
                        <h3>Position</h3>
                        <p>${user.position || 'Not specified'}</p>
                    </div>

                    <div class="profile-info">
                        <h3>Subject</h3>
                        <p>${user.subject || 'Not specified'}</p>
                    </div>

                    <div class="profile-info">
                        <h3>Favorite Teaching Method</h3>
                        <p>${user.teachingMethod || 'Not specified'}</p>
                    </div>

                    <div class="profile-info">
                        <h3>Why I Joined</h3>
                        <p>${user.whyJoined || 'Not specified'}</p>
                    </div>

                    <div class="profile-info">
                        <h3>Email</h3>
                        <p>${user.email}</p>
                    </div>

                    <button class="btn btn-secondary" onclick="AppState.logout()" style="margin-top: 20px;">
                        Log Out
                    </button>
                </div>
            `;
        }

        // ============================================
        // HELPER FUNCTIONS
        // ============================================

        function formatTimestamp(timestamp) {
            const now = Date.now();
            const diff = now - timestamp;
            const seconds = Math.floor(diff / 1000);
            const minutes = Math.floor(seconds / 60);
            const hours = Math.floor(minutes / 60);
            const days = Math.floor(hours / 24);

            if (days > 0) return `${days} day${days > 1 ? 's' : ''} ago`;
            if (hours > 0) return `${hours} hour${hours > 1 ? 's' : ''} ago`;
            if (minutes > 0) return `${minutes} minute${minutes > 1 ? 's' : ''} ago`;
            return 'Just now';
        }

        function showError(message) {
            const container = document.getElementById('error-container');
            if (container) {
                container.innerHTML = `<div class="error-message">${message}</div>`;
            }
        }

        function showSuccess(message) {
            const container = document.getElementById('error-container');
            if (container) {
                container.innerHTML = `<div class="success-message">${message}</div>`;
            }
        }

        // ============================================
        // NAVIGATION
        // ============================================

        function navigateTo(screen) {
            AppState.currentScreen = screen;
            render();
        }

        function selectCategory(category) {
            AppState.selectedCategory = category;
            render();
        }

        function viewPost(postId) {
            AppState.selectedPostId = postId;
            navigateTo('post-detail');
        }

        function deletePost(postId) {
            if (confirm('Are you sure you want to delete this post?')) {
                DB.deletePost(postId);
                navigateTo('community');
            }
        }

        // ============================================
        // RENDER FUNCTION
        // ============================================

        function render() {
            const app = document.getElementById('app');

            switch (AppState.currentScreen) {
                case 'login':
                    app.innerHTML = renderLoginScreen();
                    setupLoginForm();
                    break;
                case 'signup':
                    app.innerHTML = renderSignupScreen();
                    setupSignupForm();
                    break;
                case 'account-setup':
                    app.innerHTML = renderAccountSetupScreen();
                    setupAccountSetupForm();
                    break;
                case 'main':
                    app.innerHTML = renderMainPage();
                    break;
                case 'assessment':
                    app.innerHTML = renderAssessmentScreen();
                    setupAssessmentForm();
                    break;
                case 'assessment-results':
                    app.innerHTML = renderAssessmentResultsScreen();
                    break;
                case 'community':
                    app.innerHTML = renderCommunityHubScreen();
                    break;
                case 'create-post':
                    app.innerHTML = renderCreatePostScreen();
                    setupCreatePostForm();
                    break;
                case 'post-detail':
                    app.innerHTML = renderPostDetailScreen();
                    setupReplyForm();
                    break;
                case 'account':
                    app.innerHTML = renderPersonalAccountScreen();
                    break;
                default:
                    app.innerHTML = renderLoginScreen();
                    setupLoginForm();
            }
        }

        // ============================================
        // FORM HANDLERS
        // ============================================

        function setupLoginForm() {
            const form = document.getElementById('login-form');
            if (form) {
                form.addEventListener('submit', (e) => {
                    e.preventDefault();
                    const email = document.getElementById('login-email').value;
                    const password = document.getElementById('login-password').value;

                    const user = DB.findUser(email, password);
                    if (user) {
                        AppState.setCurrentUser(user);
                        navigateTo('main');
                    } else {
                        showError('Invalid email or password');
                    }
                });
            }
        }

        function setupSignupForm() {
            const form = document.getElementById('signup-form');
            if (form) {
                form.addEventListener('submit', (e) => {
                    e.preventDefault();

                    AppState.signupData = {
                        name: document.getElementById('signup-name').value,
                        email: document.getElementById('signup-email').value,
                        password: document.getElementById('signup-password').value,
                        role: document.getElementById('signup-role').value
                    };

                    navigateTo('account-setup');
                });
            }
        }

        function setupAccountSetupForm() {
            // Handle profile picture preview
            const picInput = document.getElementById('profile-pic-input');
            if (picInput) {
                picInput.addEventListener('change', (e) => {
                    const file = e.target.files[0];
                    if (file) {
                        const reader = new FileReader();
                        reader.onload = (event) => {
                            const preview = document.getElementById('profile-preview');
                            preview.innerHTML = `<img src="${event.target.result}" alt="Profile">`;
                            AppState.signupData.profilePic = event.target.result;
                        };
                        reader.readAsDataURL(file);
                    }
                });
            }

            const form = document.getElementById('setup-form');
            if (form) {
                form.addEventListener('submit', (e) => {
                    e.preventDefault();

                    const userData = {
                        ...AppState.signupData,
                        position: document.getElementById('setup-position').value,
                        subject: document.getElementById('setup-subject').value,
                        teachingMethod: document.getElementById('setup-method').value,
                        whyJoined: document.getElementById('setup-why').value
                    };

                    const newUser = DB.createUser(userData);
                    AppState.setCurrentUser(newUser);
                    AppState.signupData = {};
                    navigateTo('main');
                });
            }
        }

        function setupAssessmentForm() {
            const form = document.getElementById('assessment-form');
            if (form) {
                form.addEventListener('submit', (e) => {
                    e.preventDefault();

                    AppState.assessmentResults = {
                        stressLevel: parseInt(document.getElementById('stress-level').value),
                        energyLevel: parseInt(document.getElementById('energy-level').value),
                        mood: document.querySelector('input[name="mood"]:checked').value,
                        support: document.querySelector('input[name="support"]:checked').value
                    };

                    navigateTo('assessment-results');
                });
            }
        }

        function setupCreatePostForm() {
            const form = document.getElementById('create-post-form');
            if (form) {
                form.addEventListener('submit', (e) => {
                    e.preventDefault();

                    DB.createPost({
                        category: document.getElementById('post-category').value,
                        title: document.getElementById('post-title').value,
                        content: document.getElementById('post-content').value
                    });

                    navigateTo('community');
                });
            }
        }

        function setupReplyForm() {
            const form = document.getElementById('reply-form');
            if (form) {
                form.addEventListener('submit', (e) => {
                    e.preventDefault();

                    const content = document.getElementById('reply-content').value;
                    DB.addReply(AppState.selectedPostId, content);
                    render();
                });
            }
        }

        // ============================================
        // INITIALIZATION
        // ============================================

        window.addEventListener('DOMContentLoaded', () => {
            initializeData();

            // Check if user is already logged in
            if (AppState.loadCurrentUser()) {
                AppState.currentScreen = 'main';
            }

            render();
        });

        // Make functions globally available
        window.navigateTo = navigateTo;
        window.selectCategory = selectCategory;
        window.viewPost = viewPost;
        window.deletePost = deletePost;
        window.AppState = AppState;
    </script>
</body>
</html>